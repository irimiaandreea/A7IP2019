<ion-header>
    <ion-toolbar>
      <ion-buttons slot="start">
        <ion-menu-button color="light"></ion-menu-button>
      </ion-buttons>
      <ion-title>PAYMENT</ion-title>
    </ion-toolbar>
  </ion-header>

  <ion-content padding>
    
  <ion-button id="addCard" (click)="go()" expand="full" fill="clear" >Add Card</ion-button>


  <!-- add a card form -->
  <!-- /////////////////////////////////////////////////////////// -->

  <form novalidate  #cardsForm="ngForm" (ngSubmit)="saveCard(cardsForm.value)" >
    <!-- cardsForm is a variable that holds a reference to the form 
         ngForm directive suppliments the form with all the properties such as dirty, touched etc
         that directive gives us the access to the value of the form
    -->
    <!-- Value: {{addCardForm.value | json }} -->

  <div id="formular">
    <h6>Enter card details</h6>
<ion-grid>
    <ion-row>
      <ion-col>
      
          <ion-input id="cardNumber"  required  pattern="^[0-9]{16}$" #cardNr="ngModel" placeholder="Card Number" [(ngModel)]="cardModel.cardNumber" name="cardNumber">
            <!-- we use banana in a boc [()] for two way bingind data from the class to view, and from the view to class
                 and with two way binding we have the ngModel and Angular sync 
                 pattern="^(?:4[0-9]{12}(?:[0-9]{3})?|[25][1-7][0-9]{14}|6(?:011|5[0-9][0-9])[0-9]{12}|3[47][0-9]{13}|3(?:0[0-5]|[68][0-9])[0-9]{11}|(?:2131|1800|35\d{3})\d{11})$"
                -->
            <ion-icon name="card"></ion-icon> 
           </ion-input> 
      
           <!-- <small  style="color:rgb(190, 4, 4);" *ngIf="(cardNr.invalid && cardNr.touched )">Card number is required</small> -->
           <small  style="color:rgb(190, 4, 4);" *ngIf="(cardNr.invalid && cardNr.dirty )">Card number must have 16 digits</small>
          
      
      </ion-col>
    </ion-row>
    <!-- {{cardNr.valid}}
         {{cardNr.pristine}}  -->
    <ion-row>
        <ion-col>
           
            <ion-input id="mm" #mmm="ngModel" pattern="^(0?[1-9]|1[012])$" placeholder="MM" required [(ngModel)]="cardModel.mm" name="month" ></ion-input>  
            <!-- <small  style="color:rgb(190, 4, 4);" *ngIf="(mmm.invalid && mmm.touched )">Month is required</small> -->
            <small  style="color:rgb(190, 4, 4);" *ngIf="(mmm.invalid && mmm.dirty )">Invalid Month</small>
          </ion-col>
          <ion-col>
           
              <ion-input id="yy" #yyy="ngModel"   pattern="^((2|3|4|5|6|7|8|9){1}[0-9]{1})|19$" placeholder="YY" required [(ngModel)]="cardModel.yy" name="year" ></ion-input>  
              <!-- <small  style="color:rgb(190, 4, 4);" *ngIf="(yyy.invalid && yyy.touched )">Year is required</small> -->
              <small  style="color:rgb(190, 4, 4);" *ngIf="(yyy.invalid && yyy.dirty )">Invalid Year</small>
            </ion-col>
          <ion-col>
         
            <ion-input  id="cvv" #cvvv="ngModel" pattern="^[0-9]{3}$" placeholder="CVV" required [(ngModel)]="cardModel.cvv" name="cvv"></ion-input>
            <!-- <small  style="color:rgb(190, 4, 4);" *ngIf="(cvvv.invalid && cvvv.touched )"> CVV is required</small> -->
            <small  style="color:rgb(190, 4, 4);" *ngIf="(cvvv.invalid && cvvv.dirty )">Invalid CVV</small>
          </ion-col>
      </ion-row>
      <ion-row>
          <ion-col id="searchable">
            <div class="inline">
    
          <ion-icon name="flag"></ion-icon>
        </div>
        <div class="inline">
          <ion-select  id="country" #coutryy="ngModel"  required placeholder="Country" [(ngModel)]="cardModel.country" name="country">

          <ion-select-option *ngFor="let country of countries">{{country}}</ion-select-option>
    
          </ion-select>
          <!-- <small  style="color:rgb(233, 0, 0);" *ngIf="(countryy.invalid && countryy.touched )">Select a country</small> -->
      </div>
              </ion-col>
  
        </ion-row>
        <ion-row>
            <ion-col>
           
                <ion-input id="zipcode"   #zipcodee="ngModel" pattern="^[0-9]{5}$" required placeholder="Zip Code" [(ngModel)]="cardModel.zipCode" name="zipcode"></ion-input>
                <!-- <small  style="color:rgb(190, 4, 4);" *ngIf="(zipcodee.invalid && zipcodee.touched )">ZipCode is required</small> -->
                <small  style="color:rgb(190, 4, 4);" *ngIf="(zipcodee.invalid && zipcodee.dirty )">ZipCode must have 5 digits</small>
              </ion-col>
          </ion-row>
          <ion-row>
             <br/>
            </ion-row>
            <ion-row>
              <p id="pCardNumber">Incorrect card number length</p>
            </ion-row>
            <ion-row>
                <ion-col class="centered">
                    <ion-button id="save" [disabled]="cardsForm.form.invalid" type = "submit" value="Add Card" fill="clear" >Save</ion-button>
                    <ion-button id="cancel" (click)="cancel()"  fill="clear" >Cancel</ion-button>
                </ion-col>

            </ion-row>

  </ion-grid>

  </div>
</form>


<!-- {{cardsForm.value | json}} -->

<br/>
<br/>
<!-- <br/> -->
 
  <div id="cards">
    <ion-grid id ="myCards">
      <ion-row>
        <ion-col id = "cardList">
          <div *ngFor = "let card of cards" >
         
            <ion-item  id="cardListItem" lines="none" color="blue">
              <p >  {{card.cardNumber}} </p>
              <ion-icon id="trash" slot="end" (click)="deleteCardd(card.cardNumber)" size="small" name="trash"></ion-icon>
             </ion-item>
    
            </div>
  
         </ion-col>
       </ion-row>
       </ion-grid>  
  </div>
    
  </ion-content>
